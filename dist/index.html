<html>
  <head>
    <title>esbuild starter</title>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link rel="shortcut icon" href="#" />
    <link  rel="stylesheet" type="text/css" href="./main.css" />



    <script type="module" src="./index.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.10.2/p5.min.js"></script>
  </head>
  <body>
      <aside>
          <div id="share">
              <button id="share-copy">Copy Share Link</button>
          </div>
          <div id="users">
              

          </div>

      </aside>
      <main id="content">
          <section id="host-waiting-on-players" class="hidden"
              name="host-loading">
              Waiting for users to connect...
          </section>
          <section id="players-waiting-to-connect" class="hidden"
              name="players-loading">
              Connecting
          </section>
          <section id="storypointing" class="hidden" name="story-pointing" >
              <div id="results" name="results">

              </div>
              <ul>
                  <li><input type="button" class="option" value="1"/></li>
                  <li><input type="button" class="option" value="2"/></li>
                  <li><input type="button" class="option" value="3"/></li>
                  <li><input type="button" class="option" value="5"/></li>
                  <li><input type="button" class="option" value="8"/></li>
                  <li><input type="button" class="option" value="13"/></li>
                  <li><input type="button" class="option" value="21"/></li>
                  <li><input type="button" class="option" value="??"/></li>
                  <li><input type="button" class="option" value="coffee cup"/></li>
              </ul>
              <input id="storypointing-reveal" name="reveal" type="button"
              value="reveal" class="hidden"/>
              <input id="storypointing-restart" name="restart" type="button"
                                                             value="restart" class="hidden"/>

          </section>
      </main>
      <dialog id="host-info-dialog">
          <form method="dialog">
                  <label for="name">name:
                      <input name="name" type="text"/>
                  </label>
                  <input checked type="checkbox" id="host" name="category"
                                                value="host"
                                                hidden/>
                  
              <div>
                  <button id="host-info-dialog-confirm" value="default">Confirm</button>
              </div>
          </form>
      </dialog>
      <dialog id="user-info-dialog">
          <form method="dialog">
                  <label for="name">name:
                      <input name="name" type="text"/>
                  </label>
                  <fieldset>
                      <legend>Category</legend>


                      <div>
                          <input type="radio" id="spectator" name="category"
                                                             value="spectator"/>
                          <label for="category">Spectator</label>

                      </div>
                      <div>
                          <input type="radio" id="qc" name="category" value="qc"/>
                          <label for="category">QC</label>

                      </div>
                      <div>
                          <input type="radio" id="dev" name="category" value="dev"/>
                          <label for="category">Dev</label>

                      </div>
                  </fieldset>
              <div>
                  <button id="user-info-dialog-confirm" value="default">Confirm</button>
              </div>
          </form>
      </dialog>
      <script>


/*--------------------
Vars
--------------------*/
const deg = (a) => Math.PI / 180 * a
const rand = (v1, v2) => Math.floor(v1 + Math.random() * (v2 - v1))
const opt = {
  particles: window.width / 500 ? 1000 : 500,
  noiseScale: 0.009,
  angle: Math.PI / 180 * -90,
  h1: rand(0, 360),
  h2: rand(0, 360),
  s1: rand(20, 90),
  s2: rand(20, 90),
  l1: rand(30, 80),
  l2: rand(30, 80),
  strokeWeight: 1.2,
  tail: 82,
}
const Particles = []
let time = 0


/*--------------------
Particle
--------------------*/
class Particle {
  constructor(x, y) {
    this.x = x
    this.y = y
    this.lx = x
    this.ly = y
    this.vx = 0
    this.vy = 0
    this.ax = 0
    this.ay = 0
    this.hueSemen = Math.random()
    this.hue = this.hueSemen > .5 ? 20 + opt.h1 : 20 + opt.h2
    this.sat = this.hueSemen > .5 ? opt.s1 : opt.s2
    this.light = this.hueSemen > .5 ? opt.l1 : opt.l2
    this.maxSpeed = this.hueSemen > .5 ? 3 : 2
  }
  
  randomize() {
    this.hueSemen = Math.random()
    this.hue = this.hueSemen > .5 ? 20 + opt.h1 : 20 + opt.h2
    this.sat = this.hueSemen > .5 ? opt.s1 : opt.s2
    this.light = this.hueSemen > .5 ? opt.l1 : opt.l2
    this.maxSpeed = this.hueSemen > .5 ? 3 : 2
  }
  
  update() {
    this.follow()
    
    this.vx += this.ax
    this.vy += this.ay
    
    var p = Math.sqrt(this.vx * this.vx + this.vy * this.vy)
    var a = Math.atan2(this.vy, this.vx)
    var m = Math.min(this.maxSpeed, p)
    this.vx = Math.cos(a) * m
    this.vy = Math.sin(a) * m
    
    this.x += this.vx
    this.y += this.vy
    this.ax = 0
    this.ay = 0
    
    this.edges()
  }
  
  follow() {
    let angle = (noise(this.x * opt.noiseScale, this.y * opt.noiseScale, time * opt.noiseScale)) * Math.PI * 0.5 + opt.angle
    
    this.ax += Math.cos(angle)
    this.ay += Math.sin(angle)
    
  }
  
  updatePrev() {
    this.lx = this.x
    this.ly = this.y
  }
  
  edges() {
    if (this.x < 0) {
      this.x = width
      this.updatePrev()
    }
    if (this.x > width) {
      this.x = 0
      this.updatePrev()
    }
    if (this.y < 0) {
      this.y = height
      this.updatePrev()
    }
    if (this.y > height) {
      this.y = 0
      this.updatePrev()
    }
  }
  
  render () {
    stroke(`hsla(${this.hue}, ${this.sat}%, ${this.light}%, .5)`)
    line(this.x, this.y, this.lx, this.ly)
    this.updatePrev()
  }
}


/*--------------------
Setup
--------------------*/
function setup() {
  createCanvas(windowWidth, windowHeight)
  for (let i = 0; i < opt.particles; i++) {
    Particles.push(new Particle(Math.random() * width, Math.random() * height))
  }
  strokeWeight(opt.strokeWeight)
}


/*--------------------
Draw
--------------------*/
function draw() {
  time++
  background(0, 100 - opt.tail)
  
  for (let p of Particles) {
    p.update()
    p.render()
  }
}


/*--------------------
Resize
--------------------*/
function windowResized() {
  resizeCanvas(windowWidth, windowHeight)
}


      </script>
  </body>
</html>

